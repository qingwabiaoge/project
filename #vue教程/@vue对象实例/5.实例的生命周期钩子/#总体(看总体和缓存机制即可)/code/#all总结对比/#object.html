<meta charset="utf-8">
<script src="https://cdn.bootcss.com/vue/2.5.17-beta.0/vue.js"></script>
<script src="https://cdn.bootcss.com/vuex/3.0.1/vuex.js"></script>
<script src="https://cdn.bootcss.com/axios/0.18.0/axios.min.js"></script>
<script src="https://cdn.bootcss.com/vue-router/3.0.1/vue-router.min.js"></script>


<div id="app">

    <span v-for="item in todo">{{item}} </span>

    <hr>
    <!-- 和上面没差别 一样监视不了-->
    {{todo[0]}} {{todo[1]}}
    <hr>
    {{todo1}}
    <hr>
    <!--    可以监听到添加todo[0]赋值-->
    <button @click="todo[0]=10" class="btn-success">todo[0]=10</button>
    <!--    不能监听到添加新键值-->
    <button @click="todo[1]=2">todo[1]=2</button>
    <!--    不能监听到assign添加新键值-->
    <button @click="Object.assign(todo,{1:2})">Object.assign(todo,{1:2})</button>
    <!--      //原始键更新了,顺带把新键值也更新了-->
    <button @click="Object.assign(todo,{0:10,1:2})" class="btn-success">Object.assign(todo,{0:10,1:2})</button>
    <!--    可以监听到添加新键值-->
    <button @click="$set(todo,'1',2)" class="btn-success">$set(todo,'1',2)"</button>

</div>


<script>


    const vm = new Vue({
        el: '#app',

        data: {

            todo: {0: 1}
        },
        //这些钩子和v-direct render 相应情况都是一致的
        watch: {

            /*  todo(_new, _old) {
                  console.log(_new)
              },*/
            todo: {
                //对象必须深度监听才能监听到
                deep: true,
                immediate: true,
                handler(_new, _old) {
                    console.log(_new)
                }
            },

        },
        computed: {
            todo1() {
                console.log(`computed执行`)
                return this.todo
            }
        },

        beforeUpdate(){
            console.log('beforeUpdate')
            this.$nextTick().then(res=>{
                console.log('$nextTick')
            })
        },
        updated(){
            console.log('updated')
        },

    })

</script>

<style>

    .btn-success {
        background: greenyellow;
    }

</style>
