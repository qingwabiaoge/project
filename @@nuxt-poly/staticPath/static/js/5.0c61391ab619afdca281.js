webpackJsonp([5],{dCGP:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),i=a("exGp"),s=a.n(i),o={data:function(){return{articles:[],listLoading:!1,keyword:"",total:0,page:1,sels:[],uniformData:{}}},methods:{gets:function(){var t=this;return s()(n.a.mark(function e(){var a,r,i,s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={page:t.page,title:t.keyword,category:t.$route.params.category,inlcudeNoPublish:!0},t.listLoading=!0,e.next=4,t.$axios.get("/articles",{params:a});case 4:r=e.sent,i=r.total,s=r.articles,t.total=i,t.articles=s,t.listLoading=!1;case 10:case"end":return e.stop()}},e,t)}))()},filterHandler:function(t,e,a){return e[a.property]===t},addButton:function(){this.uniformData={type:"article",image:"",category:this.$route.params.id-0,publish:!0,pv:this.$store.state.tool.randomNum(1500,2e4)},this.$refs.uniform.visible=!0},editButton:function(){var t=s()(n.a.mark(function t(e,a){var r,i;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$axios.get("/article/"+a._id);case 2:r=t.sent,i=r.article,this.uniformData=i,this.$refs.uniform.visible=!0;case 6:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}(),delButton:function(){var t=s()(n.a.mark(function t(e,a){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$confirm("确认删除该记录吗?","提示",{type:"warning"});case 2:return t.next=4,this.$axios.delete("/article/"+a._id);case 4:this.gets();case 5:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}(),batchRemoveButton:function(){var t=this,e=this.sels.map(function(t){return t._id});this.$confirm("确认删除选中记录吗？","提示",{type:"warning"}).then(function(a){t.$axios.delete("/articles",{data:{ids:e}}),t.gets()})},handleSizeChange:function(t){console.log("每页 "+t+" 条")},handleCurrentChange:function(t){this.page=t,this.gets()},selsChange:function(t){this.sels=t},submit:function(){var t=s()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.uniformData._id){t.next=5;break}return t.next=3,this.$axios.post("/article",this.uniformData);case 3:t.next=7;break;case 5:return t.next=7,this.$axios.patch("/article",this.uniformData);case 7:this.gets();case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},watch:{$route:function(t,e){this.$route.params.category&&this.gets()}},created:function(){this.gets()}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"article"},[a("el-breadcrumb",{staticClass:"border-bottom-small uk-padding-bottom uk-margin-medium-bottom",attrs:{separator:">"}},[a("el-breadcrumb-item",[t._v("首页")]),t._v(" "),a("el-breadcrumb-item",[t._v("文案")]),t._v(" "),a("el-breadcrumb-item",[t._v(t._s(t.$route.params.category))])],1),t._v(" "),a("el-row",[a("el-col",{staticClass:"clearfix"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"请文章标题搜索"},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),t._v(" "),a("el-form-item",{staticClass:"uk-padding-left-sm"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.gets}},[t._v("查询")])],1),t._v(" "),a("el-form-item",{staticClass:"uk-float-right"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit-outline"},on:{click:t.addButton}},[t._v("新增文案")])],1)],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.articles,border:"","highlight-current-row":""},on:{"selection-change":t.selsChange}},[a("el-table-column",{attrs:{type:"selection",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"picture",label:"缩略图",width:"100"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.row.image,expression:"scope.row.image"}],staticStyle:{width:"50px",height:"50px"},attrs:{alt:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"title",label:"标题",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"subtitle",label:"副标题",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"publish",label:"发布/草稿",width:"100",filters:[{value:!0,label:"发布",text:"发布"},{value:!1,label:"草稿",text:"草稿"}],"filter-method":t.filterHandler},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.publish?a("span",[t._v("已发布")]):a("span",[t._v("草稿")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.editButton(e.$index,e.row)}}},[t._v("编辑\n        ")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.delButton(e.$index,e.row)}}},[t._v("删除\n        ")])]}}])})],1),t._v(" "),a("el-col",{staticClass:"toolbar uk-margin-top",attrs:{span:24}},[a("el-button",{attrs:{type:"danger",disabled:0===this.sels.length},on:{click:t.batchRemoveButton}},[t._v("批量删除")]),t._v(" "),a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":50,total:t.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),a("uniform",{ref:"uniform",attrs:{data:t.uniformData},on:{submit:t.submit}})],1)},staticRenderFns:[]};var u=a("VU/8")(o,l,!1,function(t){a("ksI4")},null,null);e.default=u.exports},ksI4:function(t,e){}});
//# sourceMappingURL=5.0c61391ab619afdca281.js.map