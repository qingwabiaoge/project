<meta charset="utf-8">
<script src="https://cdn.bootcss.com/vue/2.5.17-beta.0/vue.js"></script>
<script src="https://cdn.bootcss.com/vuex/3.0.1/vuex.js"></script>

<div id="app">

    a:{{$store.state.a}} b:{{$store.state.b}} c:{{$store.state.c}} <br>

    <button @click="$store.commit('setA',100)">setA</button>
    <button @click="$store.commit('setB',200)">setB无法响应式</button>
    <button @click="$store.commit('setC',300)"> Vue,prototype.$set(this.state, 'c', data)
    </button>
</div>


<script>

    const store = new Vuex.Store({
        //state相当于 组件里的 data:{state:{}}
        state: {
            a: 1,
        },
        getters: {
            getter() {
                return a + 1
            }
        },
        mutations: {

            setA(state, data) {
                //已声明的a可以响应式
                state.a = data
            },
            setB(state, data) {
                //未声明b不可以响应式
                state.b = data
            },
            setC(state, data) {
                //$set方法可以响应式
                Vue.prototype.$set(this.state, 'c', data)
            }
        }

    })

    const vm = new Vue({
        el: '#app',
        store,
        watch: {
            //普通watch
            '$store.state.a'(n, o) {
                console.log(n, o)
            },


            '$store.state': {
                //深度watch
                deep: true,
                handler: function (_new, _old) {
                    console.log(_new, _old)
                },
            }

        }

    })

</script>