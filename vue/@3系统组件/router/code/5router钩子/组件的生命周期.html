<meta charset="utf-8">
<script src="https://cdn.bootcss.com/vue/2.5.17-beta.0/vue.js"></script>
<script src="https://cdn.bootcss.com/vue-router/3.0.1/vue-router.min.js"></script>


<style>
    div {
        border: 1px solid #0f0;
        margin: 20px
    }

    div > div {
        border: 1px solid #f00;
    }

    div > div > div {
        border: 1px solid #00f;
    }


</style>
<div id="app">
    <router-link to="sub1">sub1</router-link>
    <router-link to="sub2">sub2</router-link>

    <router-view></router-view>

</div>
<script>

    const sub1 = {
        template: '<div>sub1</div>',
        beforeRouteEnter (to, from, next) {
            console.log('beforeRouteEnter')
            next()
            // 在渲染该组件的对应路由被 confirm 前调用
            // 不！能！获取组件实例 `this`
            // 因为当守卫执行前，组件实例还没被创建
        },
        beforeRouteUpdate (to, from, next) {
            console.log('beforeRouteUpdate')
            // 在当前路由改变，但是该组件被复用时调用
            // 举例来说，对于一个带有动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，
            // 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。
            // 可以访问组件实例 `this`
            next()
        },
        beforeRouteLeave (to, from, next) {
            console.log('beforeRouteLeave')
            // 导航离开该组件的对应路由时调用
            // 可以访问组件实例 `this`
            next()
        },
        created() {
            console.log('01creat')
        },
        destroyed() {
            console.log('01distroy')
        }
    }
    const sub2={
        template:'<div>sub</div>',
        created() {
            console.log('02creat')
        },
        destroyed() {
            console.log('02distroy')
        }
    }

    const router = new VueRouter({
            routes: [


                    {
                        path: '/sub1',
                        name: 'sub1',
                        component: sub1,
                        beforeEnter: (to, from, next) => {
                           console.log('beforeEnter')
                            next()
                        }
                    },
                    {
                        path: '/sub2',
                        name: 'sub2',
                        component: sub2,
                    }

                ]


        }
    )
    const vm = new Vue({
        el: '#app',
        router
    })
    router.beforeEach((to, from, next) => {//路由的声明周期 进入路由时间的钩子函数
        console.log('beforeEach')//要离开路由的$route信息


        if (to.meta.admin === true) {
            console.log('需要admin授权')
        }
        next()
    })
    router.afterEach((to, from) => {
       console.log('afterEach')
    })
</script>
